2025-01-25 16:01:09.042 [INFO] chimera - Starting execution of all modes
2025-01-25 16:01:09.172 [INFO] chimera - Starting inventory mode execution
2025-01-25 16:01:09.868 [ERROR] chimera::modes::inventory - Execution error: Failed to get Kubernetes pods: No such file or directory (os error 2)
2025-01-25 16:01:09.868 [ERROR] chimera::modes::inventory - Failed to get Kubernetes containers: Execution error: Failed to get Kubernetes pods: No such file or directory (os error 2)
2025-01-25 16:01:10.401 [ERROR] chimera::modes::inventory - Execution error: Failed to get container IDs: No such file or directory (os error 2)
2025-01-25 16:01:10.401 [ERROR] chimera::modes::inventory - Failed to get containers using podman: Execution error: Failed to get container IDs: No such file or directory (os error 2)
2025-01-25 16:01:10.402 [INFO] chimera::types - [INVEN] {"hostname":"orzo.wobblys.world","ip":"192.168.220.30","os":"Linux rolling Arch Linux","cores":2,"cpu":"Common KVM processor","memory":7945,"disks":[{"name":"/dev/sda2","mountPoint":"/","filesystem":"ext4","totalSpace":15891,"availableSpace":9989},{"name":"/dev/sda1","mountPoint":"/boot","filesystem":"ext4","totalSpace":114,"availableSpace":2}],"networkAdapters":"","ports":[{"port":21,"protocol":"TCP","process":{"pid":298,"name":"vsftpd"},"version":"IPv4","state":"listen"},{"port":22,"protocol":"TCP","process":{"pid":297,"name":"sshd"},"version":"IPv4","state":"listen"},{"port":443,"protocol":"TCP","process":{"pid":389,"name":"nginx"},"version":"IPv4","state":"listen"},{"port":3306,"protocol":"TCP","process":{"pid":329,"name":"mariadbd"},"version":"IPv4","state":"listen"}],"connections":[{"localAddress":"0.0.0.0:22","remoteAddress":"0.0.0.0:0","state":"listen","protocol":"TCP-IPv4","process":{"pid":297,"name":"sshd"}},{"localAddress":"0.0.0.0:21","remoteAddress":"0.0.0.0:0","state":"listen","protocol":"TCP-IPv4","process":{"pid":298,"name":"vsftpd"}},{"localAddress":"0.0.0.0:443","remoteAddress":"0.0.0.0:0","state":"listen","protocol":"TCP-IPv4","process":{"pid":389,"name":"nginx"}},{"localAddress":"127.0.0.1:42097","remoteAddress":"0.0.0.0:0","state":"listen","protocol":"TCP-IPv4","process":{"pid":309,"name":"containerd"}},{"localAddress":"0.0.0.0:3306","remoteAddress":"0.0.0.0:0","state":"listen","protocol":"TCP-IPv4","process":{"pid":329,"name":"mariadbd"}},{"localAddress":"192.168.220.30:3306","remoteAddress":"192.168.220.69:64935","state":"established","protocol":"TCP-IPv4","process":{"pid":329,"name":"mariadbd"}},{"localAddress":"192.168.220.30:3306","remoteAddress":"192.168.220.69:64931","state":"established","protocol":"TCP-IPv4","process":{"pid":329,"name":"mariadbd"}},{"localAddress":":::22","remoteAddress":":::0","state":"listen","protocol":"TCP-IPv4","process":{"pid":297,"name":"sshd"}},{"localAddress":"192.168.220.30:3306","remoteAddress":"192.168.220.69:64929","state":"established","protocol":"TCP-IPv4","process":{"pid":329,"name":"mariadbd"}},{"localAddress":"192.168.220.30:3306","remoteAddress":"192.168.220.69:64933","state":"established","protocol":"TCP-IPv4","process":{"pid":329,"name":"mariadbd"}},{"localAddress":"192.168.220.30:47502","remoteAddress":"192.168.220.132:389","state":"established","protocol":"TCP-IPv4","process":{"pid":280,"name":"sssd_be"}},{"localAddress":":::3306","remoteAddress":":::0","state":"listen","protocol":"TCP-IPv4","process":{"pid":329,"name":"mariadbd"}},{"localAddress":"192.168.220.30:3306","remoteAddress":"192.168.220.69:64930","state":"established","protocol":"TCP-IPv4","process":{"pid":329,"name":"mariadbd"}},{"localAddress":"192.168.220.30:3306","remoteAddress":"192.168.220.69:64932","state":"established","protocol":"TCP-IPv4","process":{"pid":329,"name":"mariadbd"}},{"localAddress":"192.168.220.30:3306","remoteAddress":"192.168.220.69:64927","state":"established","protocol":"TCP-IPv4","process":{"pid":329,"name":"mariadbd"}},{"localAddress":"192.168.220.30:3306","remoteAddress":"192.168.220.69:64936","state":"established","protocol":"TCP-IPv4","process":{"pid":329,"name":"mariadbd"}},{"localAddress":"192.168.220.30:3306","remoteAddress":"192.168.220.69:64934","state":"established","protocol":"TCP-IPv4","process":{"pid":329,"name":"mariadbd"}},{"localAddress":"192.168.220.30:3306","remoteAddress":"192.168.220.69:64928","state":"established","protocol":"TCP-IPv4","process":{"pid":329,"name":"mariadbd"}},{"localAddress":"192.168.220.30:22","remoteAddress":"10.100.136.203:34238","state":"established","protocol":"TCP-IPv4","process":{"pid":652,"name":"sshd"}}],"services":[{"name":"containerd.service","state":"active","startMode":null,"status":"active"},{"name":"dbus.service","state":"active","startMode":null,"status":"active"},{"name":"docker.service","state":"active","startMode":"enabled","status":"active"},{"name":"getty@tty1.service","state":"active","startMode":"enabled","status":"active"},{"name":"kmod-static-nodes.service","state":"active","startMode":null,"status":"active"},{"name":"●","state":"loaded","startMode":null,"status":"inactive"},{"name":"●","state":"loaded","startMode":null,"status":"inactive"},{"name":"mariadb.service","state":"active","startMode":"enabled","status":"active"},{"name":"NetworkManager-wait-online.service","state":"active","startMode":"enabled","status":"active"},{"name":"NetworkManager.service","state":"active","startMode":"enabled","status":"active"},{"name":"nginx.service","state":"active","startMode":"enabled","status":"active"},{"name":"●","state":"loaded","startMode":null,"status":"inactive"},{"name":"●","state":"loaded","startMode":null,"status":"inactive"},{"name":"sshd.service","state":"active","startMode":"enabled","status":"active"},{"name":"sssd.service","state":"active","startMode":"enabled","status":"active"},{"name":"systemd-fsck@dev-disk-by\\x2duuid-6d5c251f\\x2d6292\\x2d4741\\x2db7fc\\x2dafb0c70004de.service","state":"active","startMode":null,"status":"active"},{"name":"systemd-journal-flush.service","state":"active","startMode":null,"status":"active"},{"name":"systemd-journald.service","state":"active","startMode":null,"status":"active"},{"name":"systemd-logind.service","state":"active","startMode":null,"status":"active"},{"name":"systemd-modules-load.service","state":"active","startMode":null,"status":"active"},{"name":"systemd-network-generator.service","state":"active","startMode":"enabled","status":"active"},{"name":"●","state":"loaded","startMode":null,"status":"inactive"},{"name":"systemd-networkd.service","state":"active","startMode":"enabled","status":"active"},{"name":"systemd-random-seed.service","state":"active","startMode":null,"status":"active"},{"name":"systemd-remount-fs.service","state":"active","startMode":null,"status":"active"},{"name":"systemd-sysctl.service","state":"active","startMode":null,"status":"active"},{"name":"systemd-timesyncd.service","state":"active","startMode":"enabled","status":"active"},{"name":"systemd-tmpfiles-setup-dev-early.service","state":"active","startMode":null,"status":"active"},{"name":"systemd-tmpfiles-setup-dev.service","state":"active","startMode":null,"status":"active"},{"name":"systemd-tmpfiles-setup.service","state":"active","startMode":null,"status":"active"},{"name":"systemd-udev-trigger.service","state":"active","startMode":null,"status":"active"},{"name":"systemd-udevd.service","state":"active","startMode":null,"status":"active"},{"name":"systemd-update-utmp.service","state":"active","startMode":null,"status":"active"},{"name":"systemd-user-sessions.service","state":"active","startMode":null,"status":"active"},{"name":"systemd-vconsole-setup.service","state":"active","startMode":null,"status":"active"},{"name":"user-runtime-dir@0.service","state":"active","startMode":null,"status":"active"},{"name":"user@0.service","state":"active","startMode":null,"status":"active"},{"name":"vsftpd.service","state":"active","startMode":"enabled","status":"active"},{"name":"●","state":"loaded","startMode":null,"status":"inactive"},{"name":"wobbly.service","state":"active","startMode":null,"status":"active"}],"users":[{"name":"root","uid":"0","gid":"0","isAdmin":true,"groups":["root","root"],"isLocal":true,"shell":null},{"name":"bin","uid":"1","gid":"1","isAdmin":false,"groups":["bin","sys","daemon"],"isLocal":true,"shell":null},{"name":"daemon","uid":"2","gid":"2","isAdmin":false,"groups":["daemon","adm","bin"],"isLocal":true,"shell":null},{"name":"mail","uid":"8","gid":"12","isAdmin":false,"groups":["mail"],"isLocal":true,"shell":null},{"name":"ftp","uid":"14","gid":"11","isAdmin":false,"groups":["ftp"],"isLocal":true,"shell":null},{"name":"http","uid":"33","gid":"33","isAdmin":false,"groups":["http"],"isLocal":true,"shell":null},{"name":"nobody","uid":"65534","gid":"65534","isAdmin":false,"groups":["nobody"],"isLocal":true,"shell":null},{"name":"dbus","uid":"81","gid":"81","isAdmin":false,"groups":["dbus"],"isLocal":true,"shell":null},{"name":"systemd-coredump","uid":"980","gid":"980","isAdmin":false,"groups":["systemd-coredump"],"isLocal":true,"shell":null},{"name":"systemd-network","uid":"979","gid":"979","isAdmin":false,"groups":["systemd-network"],"isLocal":true,"shell":null},{"name":"systemd-oom","uid":"978","gid":"978","isAdmin":false,"groups":["systemd-oom"],"isLocal":true,"shell":null},{"name":"systemd-journal-remote","uid":"977","gid":"977","isAdmin":false,"groups":["systemd-journal-remote"],"isLocal":true,"shell":null},{"name":"systemd-journal-upload","uid":"976","gid":"976","isAdmin":false,"groups":["systemd-journal-upload"],"isLocal":true,"shell":null},{"name":"systemd-resolve","uid":"975","gid":"975","isAdmin":false,"groups":["systemd-resolve"],"isLocal":true,"shell":null},{"name":"systemd-timesync","uid":"974","gid":"974","isAdmin":false,"groups":["systemd-timesync"],"isLocal":true,"shell":null},{"name":"tss","uid":"973","gid":"973","isAdmin":false,"groups":["tss"],"isLocal":true,"shell":null},{"name":"uuidd","uid":"68","gid":"68","isAdmin":false,"groups":["uuidd"],"isLocal":true,"shell":null},{"name":"polkitd","uid":"102","gid":"102","isAdmin":false,"groups":["polkitd","proc"],"isLocal":true,"shell":null},{"name":"avahi","uid":"972","gid":"972","isAdmin":false,"groups":["avahi"],"isLocal":true,"shell":null},{"name":"mysql","uid":"970","gid":"970","isAdmin":false,"groups":["mysql"],"isLocal":true,"shell":null},{"name":"named","uid":"40","gid":"40","isAdmin":false,"groups":["named"],"isLocal":true,"shell":null},{"name":"ntp","uid":"87","gid":"87","isAdmin":false,"groups":["ntp"],"isLocal":true,"shell":null},{"name":"fcron","uid":"23","gid":"23","isAdmin":false,"groups":["fcron"],"isLocal":true,"shell":null},{"name":"git","uid":"969","gid":"969","isAdmin":false,"groups":["git"],"isLocal":true,"shell":null},{"name":"dkb","uid":"1064","gid":"1064","isAdmin":false,"groups":["dkb"],"isLocal":true,"shell":null},{"name":"ldap","uid":"439","gid":"439","isAdmin":false,"groups":["ldap"],"isLocal":true,"shell":null}],"shares":[],"containers":[]}
2025-01-25 16:01:10.402 [INFO] chimera - Successfully wrote inventory data
2025-01-25 16:01:10.404 [INFO] chimera - Starting credentials mode execution with magic value: 62
2025-01-25 16:01:10.405 [INFO] chimera::modes::credentials::platform::unix - Password changing to SudontPwnM3!1860 for user: root
2025-01-25 16:01:10.595 [INFO] chimera::modes::credentials::platform::unix - Successfully changed password for user: root
2025-01-25 16:01:10.595 [INFO] chimera::types - [CREDS] Credentials managed successfully
2025-01-25 16:01:10.595 [INFO] chimera - Starting baseline mode execution
2025-01-25 16:01:10.595 [INFO] chimera - Platform: Linux
2025-01-25 16:01:10.596 [INFO] chimera::modes::baseline::platform::unix - Establishing system baseline
2025-01-25 16:01:10.596 [INFO] chimera::modes::baseline::platform::unix - Setting up logging
2025-01-25 16:01:10.596 [INFO] chimera::modes::baseline::platform::unix - Setting up syslog and auditd
2025-01-25 16:01:10.596 [INFO] chimera::modes::baseline::platform::unix - Detected package manager: Pacman
2025-01-25 16:01:10.596 [INFO] chimera::modes::baseline::platform::unix - Detected package manager: Pacman
2025-01-25 16:01:10.596 [WARN] chimera::modes::baseline::platform::unix - Failed to setup syslog: Unknown OS
2025-01-25 16:01:10.596 [INFO] chimera::modes::baseline::platform::unix - Adding system hardening measures
2025-01-25 16:01:10.596 [INFO] chimera::modes::baseline::platform::unix - Hardening Unix system
2025-01-25 16:01:10.596 [INFO] chimera::modes::baseline::platform::unix - Creating secure directories
2025-01-25 16:01:10.601 [INFO] chimera::modes::baseline::platform::unix - Configuring up rbash
2025-01-25 16:01:10.601 [INFO] chimera::modes::baseline::platform::unix - Starting rbash configuration
2025-01-25 16:01:10.601 [INFO] chimera::modes::baseline::platform::unix - Creating backup of passwd file
2025-01-25 16:01:10.602 [INFO] chimera::modes::baseline::platform::unix - Modifying user shells to use rbash
2025-01-25 16:01:10.707 [INFO] chimera::modes::baseline::platform::unix - Updating shell rc files
2025-01-25 16:01:15.547 [INFO] chimera::modes::baseline::platform::unix - Configuring PAM
2025-01-25 16:01:15.547 [INFO] chimera::modes::baseline::platform::unix - Starting PAM configuration and repair
2025-01-25 16:01:15.547 [INFO] chimera::modes::baseline::platform::unix - Detected package manager: Pacman
2025-01-25 16:01:15.547 [INFO] chimera::modes::baseline::platform::unix - Detected package manager: Pacman
2025-01-25 16:01:15.547 [INFO] chimera::modes::baseline::platform::unix - Creating backup of PAM configuration
2025-01-25 16:01:16.151 [INFO] chimera::modes::baseline::platform::unix - Configuring PAM for Arch system
2025-01-25 16:01:16.152 [WARN] chimera::modes::baseline::platform::unix - BACKUPDIR not set, skipping PAM config restore
2025-01-25 16:01:16.152 [INFO] chimera::modes::baseline::platform::unix - Reinstalling PAM package
2025-01-25 16:01:51.601 [ERROR] chimera::modes::baseline::platform::unix - PAM configuration failed: Execution error: Failed to execute command: pacman
2025-01-25 16:01:51.602 [INFO] chimera::modes::baseline::platform::unix - Securing php.ini files
2025-01-25 16:02:39.595 [INFO] chimera::modes::baseline::platform::unix - Applying sysctl settings
2025-01-25 16:02:39.757 [INFO] chimera::modes::baseline::platform::unix - Configuring SSH security settings
2025-01-25 16:02:39.757 [INFO] chimera::modes::baseline::platform::unix - Configuring SSH security settings
2025-01-25 16:02:39.758 [INFO] chimera::modes::baseline::platform::unix - Validating new SSH configuration
2025-01-25 16:02:39.787 [INFO] chimera::modes::baseline::platform::unix - Attempting to restart SSH service
2025-01-25 16:02:39.885 [INFO] chimera::modes::baseline::platform::unix - Configuring kernel module restrictions
2025-01-25 16:02:39.885 [INFO] chimera::modes::baseline::platform::unix - Configuring login security parameters
2025-01-25 16:02:39.899 [INFO] chimera::modes::baseline::platform::unix - System hardening completed successfully
2025-01-25 16:02:39.900 [INFO] chimera::modes::baseline::platform::unix - System hardening completed
2025-01-25 16:02:39.900 [INFO] chimera::types - [BASELINE] Credentials managed successfully
2025-01-25 16:02:39.900 [INFO] chimera - Starting update mode execution
2025-01-25 16:02:39.900 [INFO] chimera::types - [UPDATE] Update completed
2025-01-25 16:02:39.900 [INFO] chimera - Starting serve mode on port 44372
2025-01-25 16:02:39.900 [INFO] chimera::modes::serve - Starting file server on port 44372 in background
2025-01-25 16:02:39.903 [INFO] chimera::types - [SERVE] Server started in background on port 44372
2025-01-25 16:02:39.903 [INFO] chimera - All modes completed successfully
2025-01-25 16:02:39.903 [INFO] chimera - Starting internal serve mode on port 44372
2025-01-25 16:02:39.907 [INFO] chimera::server - Starting file server on port 44372
2025-01-25 16:05:14.079 [INFO] chimera::server - Successfully served and deleted file: inventory.json
